

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Gyrokinetic Simulation in the 2000s &mdash; GACODE</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/contentui.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        <script src="../_static/contentui.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Gallery of classic GYRO images (circa 2003)" href="gyro_gallery.html" />
    <link rel="prev" title="GYRO verification and validation (pre 2010)" href="gyro_vv.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> GACODE
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../license.html">GACODE License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../download.html">Download and user agreement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Environment setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../build.html">Build from sources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../zreferences.html">References</a></li>
</ul>
<p class="caption"><span class="caption-text">Codes</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../neo.html">NEO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tgyro.html">TGYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cgyro.html">CGYRO</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../gyro.html">GYRO</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../gyro.html#quick-links">Quick links</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="gyro_table.html">Tabular list for input.gyro</a></li>
<li class="toctree-l3"><a class="reference internal" href="gyro_list.html">Alphabetical list for input.gyro</a></li>
<li class="toctree-l3"><a class="reference internal" href="gyro_vv.html">GYRO verification and validation (pre 2010)</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Gyrokinetic Simulation in the 2000s</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#prehistory">Prehistory</a></li>
<li class="toctree-l4"><a class="reference internal" href="#design-history">Design History</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yearly-publication-synopsis">Yearly Publication Synopsis</a></li>
<li class="toctree-l4"><a class="reference internal" href="#a-computational-science-and-user-perspective">A Computational Science and User Perspective</a></li>
<li class="toctree-l4"><a class="reference internal" href="#urban-legends">Urban Legends</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="gyro_gallery.html">Gallery of classic GYRO images (circa 2003)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../gyro.html#overview">Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tglf.html">TGLF</a></li>
</ul>
<p class="caption"><span class="caption-text">Physics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../geometry.html">FLUX-SURFACE GEOMETRY</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rotation.html">PLASMA ROTATION</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_gacode.html">input.gacode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../shortfall.html">DIII-D L-mode shortfall</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">GACODE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../gyro.html">GYRO</a> &raquo;</li>
        
      <li>Gyrokinetic Simulation in the 2000s</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/gyro/gyro_history.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="gyrokinetic-simulation-in-the-2000s">
<h1>Gyrokinetic Simulation in the 2000s<a class="headerlink" href="#gyrokinetic-simulation-in-the-2000s" title="Permalink to this headline">¶</a></h1>
<p><em>[This overview was written during the period 2006-2009]</em></p>
<hr class="docutils" />
<p>In the text below we describe the prehistory, history and present use of the GYRO code.  A broad spectrum of published code applications is summarized, and the key role played by GYRO within the US fusion program is clarified.  More historical details can be found in the Spring 2008 Issue of SciDAC review, whereas the
<a class="reference external" href="https://github.com/gafusion/doc/blob/master/manuals/gyro/gyro_technical_manual.pdf">Technical Manual</a>  provides a detailed description of the underlying equations and discretization schemes.</p>
<div class="section" id="prehistory">
<h2>Prehistory<a class="headerlink" href="#prehistory" title="Permalink to this headline">¶</a></h2>
<p>The use of gyrokinetic codes at General Atomics began in 1994 with the acquisition of the linear gyrokinetic stability code GSTOTAL <a class="bibtex reference internal" href="../zreferences.html#kotschenreuther-1995" id="id1">[KRT95]</a>.  GSTOTAL was an Eulerian initial-value code with trapped and passing particles (ions and electrons) as well as collisional and electromagnetic physics.  GSTOTAL represented an enormous technical advance in simulation capability, comparable in significance to Kotschenreuther’s prior invention of the well-known <span class="math notranslate nohighlight">\(\delta f\)</span> method <a class="bibtex reference internal" href="../zreferences.html#kotschenreuther-1988" id="id2">[Kot88]</a> for particle simulation. The time-advance scheme in GSTOTAL was <em>fully implicit</em> and allowed use of timesteps much larger than those imposed by the electron parallel Courant limit. Historically speaking, GSTOTAL was the first step toward a practical <em>nonlinear</em> gyrokinetic code.  With the addition of plasma shaping and finite-<span class="math notranslate nohighlight">\(\delta B\)</span> effects, GSTOTAL evolved into the linear stability code GKS.  GKS has been routinely used in DIII-D experimental studies for over a decade.  Combined with results from nonlinear flux-tube gyrofluid simulations <a class="bibtex reference internal" href="../zreferences.html#waltz-1994" id="id3">[WKM94]</a><a class="bibtex reference internal" href="../zreferences.html#waltz-1995" id="id4">[WKMH95]</a>, GKS was crucial in the development of GLF23 <a class="bibtex reference internal" href="../zreferences.html#waltz-1997" id="id5">[WSD+97]</a>, one of the most popular transport models worldwide.</p>
<p>In what follows, we will draw a distinction between local and global simulations.  In this context, <em>local</em> means <em>flux-tube</em>.  Flux-tube simulations represent the <span class="math notranslate nohighlight">\(\rho_* \rightarrow 0\)</span> limit of global simulations, for which the transport scaling is purely gyroBohm <a class="bibtex reference internal" href="../zreferences.html#candy-2004a" id="id6">[CWD04]</a> <a class="footnote-reference brackets" href="#id93" id="id7">1</a>.   Here, <span class="math notranslate nohighlight">\(\rho_* = \rho_s/a\)</span> is the ratio of gyroradius to system size, with <span class="math notranslate nohighlight">\(\rho_s\)</span> the ion-sound Larmor radius, and <span class="math notranslate nohighlight">\(a\)</span> the plasma minor radius.</p>
<p>Nonlinear flux-tube ‘’gyrofluid’’ simulations by Beer, Dorland, Hammett, Snyder, Waltz and others provided the key physics discoveries in the mid-1990s, years before the same phenomena were observed in gyrokinetic simulations.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Gyrofluid simulations demonstrated that nonlinear, self-generated (zonal) flows control the nonlinear saturation of transport <a class="bibtex reference internal" href="../zreferences.html#waltz-1994" id="id8">[WKM94]</a><a class="bibtex reference internal" href="../zreferences.html#waltz-1995" id="id9">[WKMH95]</a><a class="bibtex reference internal" href="../zreferences.html#dorland-1993" id="id10">[DH93]</a><a class="bibtex reference internal" href="../zreferences.html#hammett-1994" id="id11">[HBC+94]</a><a class="bibtex reference internal" href="../zreferences.html#beer-1996b" id="id12">[BH96b]</a>, and that equilibrium <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> shear can quench transport if the shearing rates are comparable to maximum linear growth rates <a class="bibtex reference internal" href="../zreferences.html#waltz-1994" id="id13">[WKM94]</a><a class="bibtex reference internal" href="../zreferences.html#waltz-1995" id="id14">[WKMH95]</a>.</p>
</div>
<p>Nonlinear gyrofluid codes were the first to treat trapped electron <a class="bibtex reference internal" href="../zreferences.html#beer-1996" id="id15">[BH96a]</a> and electromagnetic <a class="bibtex reference internal" href="../zreferences.html#snyder-2001" id="id16">[SH01]</a> turbulence.  The first major contribution from nonlinear <em>gyrokinetic</em> codes was the verification of the importance of Rosenbluth-Hinton (RH) residual flows <a class="bibtex reference internal" href="../zreferences.html#rosenbluth-1998" id="id17">[RH98]</a> as demonstrated by the flux-tube particle-in-cell (PIC) code PG3EQ <a class="bibtex reference internal" href="../zreferences.html#dimits-1996" id="id18">[DWBC96]</a>. RH flows were shown to give rise to an upshift in the nonlinear threshold for ITG-ae <a class="footnote-reference brackets" href="#id94" id="id19">2</a> turbulence. The nonlinear upshift was later named the <em>Dimits shift</em> after its discoverer.  The difficulty in properly treating this residual in gyrofluid models was one motivating factor for a switch from gyrofluid to gyrokinetic simulation.  To this end, by building upon the GSTOTAL implicit scheme, Dorland and co-workers created the <strong>nonlinear Eulerian gyrokinetic code</strong> GS2 <a class="bibtex reference internal" href="../zreferences.html#dorland-2000" id="id20">[DJKR00]</a>.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>GS2 <a class="bibtex reference internal" href="../zreferences.html#dorland-2000" id="id21">[DJKR00]</a> was the first nonlinear gyrokinetic code to include the crucial nonadiabatic electron dynamics required for trapped electron mode and electromagnetic physics.</p>
</div>
</div>
<div class="section" id="design-history">
<h2>Design History<a class="headerlink" href="#design-history" title="Permalink to this headline">¶</a></h2>
<p>Development of GYRO started in 1999.  The primary goal was to generalize GS2 by retaining profile-variation effects to allow, in principle, deviations from pure gyroBohm scaling.  The numerical methods for GYRO were initially patterned after GS2 wherever possible.  In the end, many significant departures from GS2 were required to meet the GYRO design target <em>and</em> to simultaneously increase computational efficiency.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>By 2001, GYRO had the ability to operate either globally using Dirichlet (zero-value) radial boundary conditions, or locally using flux-tube (periodic) boundary conditions.</p>
</div>
<p>An implicit-explicit Runge-Kutta (IMEX-RK) integrator was eventually added to overcome the electrostatic-Alfvén wave Courant limit, which can severely limit the timestep for large-domain simulations.  Independently, a novel poloidal discretization scheme solved the <strong>Ampere cancellation problem</strong> <a class="bibtex reference internal" href="../zreferences.html#candy-2003" id="id22">[CW03b]</a>.  The latter pathology hampered electromagnetic PIC simulation for over a decade.  To date, only a single PIC code <a class="bibtex reference internal" href="../zreferences.html#chen-2003" id="id23">[CPC+03]</a> has successfully treated finite-<span class="math notranslate nohighlight">\(\beta\)</span> fluctuations with full electron dynamics, and only after implementing an analog of the GYRO scheme.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>By 2002, GYRO <a class="bibtex reference internal" href="../zreferences.html#candy-2003" id="id24">[CW03b]</a> achieved robust operation with its physics design targets.  This was demonstrated <a class="bibtex reference internal" href="../zreferences.html#candy-2003b" id="id25">[CW03a]</a> in realistic simulations of dimensionally similar Bohm scaled DIII-D L-mode discharges.</p>
</div>
</div>
<div class="section" id="yearly-publication-synopsis">
<h2>Yearly Publication Synopsis<a class="headerlink" href="#yearly-publication-synopsis" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id26">
<h3>2002<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<p>The first application of GYRO was to use the global capability with adiabatic electons to systematically examine the breaking of gyroBohm scaling (including what are now called, somewhat ambiguously, <em>nonlocal</em> or <em>turbulence spreading</em> effects) via profile variation <a class="bibtex reference internal" href="../zreferences.html#waltz-2002" id="id27">[WCR02]</a>.</p>
</div>
<div class="section" id="id28">
<h3>2003<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h3>
<p>GYRO numerical algorithms were documented <a class="bibtex reference internal" href="../zreferences.html#candy-2003" id="id29">[CW03b]</a>, although publication was significantly delayed after the first submission was lost in transit.  A significant amount of linear and nonlinear benchmark data related to the Cyclone base case was given, as were parameter scans for nonlinear electromagnetic variants of the Cyclone case.  On the experimental side, simulations of DIII-D L-mode discharges were shown to match experimental power flow data within error bars <a class="bibtex reference internal" href="../zreferences.html#candy-2003b" id="id30">[CW03a]</a> on the ion temperature gradient.  These simulations were physically realistic, and included finite-<span class="math notranslate nohighlight">\(\beta\)</span> effects, and collisional electron physics at real mass ratio, equilibrium <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> and profile shearing, as well as plasma shaping.</p>
</div>
<div class="section" id="id31">
<h3>2004<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h3>
<p>Turbulent dynamos in the tokamak current-voltage relation <a class="bibtex reference internal" href="../zreferences.html#hinton-2004" id="id32">[HWC04]</a> were studied, showing that the turbulent dynamo EMF drives large current density corrugations at low-order rational surfaces, but little net current.  In other work, we attempted to correct misunderstanding generated by a highly-publicized global <span class="math notranslate nohighlight">\(\rho_*\)</span>-scan <a class="bibtex reference internal" href="../zreferences.html#lin-2002" id="id33">[LEHT02]</a> with highly artificial profiles.  The single scan appeared to suggest a universal range in <span class="math notranslate nohighlight">\(\rho_*\)</span> marking the transition from Bohm to gyroBohm scaling.  GYRO work established that the transition <strong>cannot</strong> be characterized by a universal curve; rather, the transition is highly dependent on the profile shape <a class="bibtex reference internal" href="../zreferences.html#candy-2004a" id="id34">[CWD04]</a> <a class="footnote-reference brackets" href="#id95" id="id35">3</a>.</p>
<p>During this period, there were persistent claims from certain groups that transport is depressed near a <span class="math notranslate nohighlight">\(q_\mathrm{min}\)</span>-surface where there is a <em>gap</em> in singular surfaces <a class="bibtex reference internal" href="../zreferences.html#kishimoto-2000" id="id36">[KKH+00]</a>.  Global GYRO simulations indicated that transport flows tends to vary monotonically across <span class="math notranslate nohighlight">\(q_\mathrm{min}\)</span> surfaces <a class="bibtex reference internal" href="../zreferences.html#candy-2004b" id="id37">[CWR04]</a> (as expected from linear theory and flux-tube gyrofluid simulations <a class="bibtex reference internal" href="../zreferences.html#waltz-1994" id="id38">[WKM94]</a><a class="bibtex reference internal" href="../zreferences.html#waltz-1995" id="id39">[WKMH95]</a>) due to the appearance of nonresonant modes. These modes are absent in some simplified gyrofluid simulations which at first appeared to confirm the barrier hypothesis.</p>
</div>
<div class="section" id="id40">
<h3>2005<a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h3>
<p>The first systematic gyrokinetic study of particle transport and impurity dynamics was made with GYRO as thesis work for a UCSD graduate student.   In particular, temperature-gradient-induced particle pinches, thermal and energetic helium ash transport, differential flows in D-T plasmas, and collisional effects on particle pinches were examined <a class="bibtex reference internal" href="../zreferences.html#estrada-2005" id="id41">[EMCW05]</a>.  Scans in temperature and density gradients (moving from ITG- to TEM-dominated transport), <span class="math notranslate nohighlight">\(T_i/T_e\)</span>, <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> and parallel velocity shear <a class="bibtex reference internal" href="../zreferences.html#kinsey-2005" id="id42">[KWC05]</a> were also published.</p>
<p>A detailed study of the beta dependence of electron and ion transport was made <a class="bibtex reference internal" href="../zreferences.html#candy-2005" id="id43">[Can05]</a>.  This latter work documents the so-called <em>beta runaway</em> phenomenon, which occurs at about half of the MHD crictical beta; as of Winter 2009, it remains an unsolved problem in gyrokinetics.</p>
<p>Using a profile feedback scheme, simulations starting with DIII-D L-mode profiles successfully (and slightly) relaxed the experimental temperature and density so that simulated power flows matched experimental ones <a class="bibtex reference internal" href="../zreferences.html#waltz-2005" id="id44">[WCH+05]</a>.  This sort of capability was an early landmark in the development of a more comprehensive steady-state gyrokinetic transport code.  GYRO simulations also yielded several examples of nonlocal transport <a class="bibtex reference internal" href="../zreferences.html#waltz-2005b" id="id45">[WC05]</a><a class="bibtex reference internal" href="../zreferences.html#waltz-2005c" id="id46">[Wal05]</a>; in particular, turbulence <em>draining</em> from unstable to less unstable (or stable) regions.  At this time, the detailed radial structure of nonlinear profile perturbations was also explored: persistent (i.e., time-averaged) structure tied to rational surfaces <a class="bibtex reference internal" href="../zreferences.html#waltz-2005" id="id47">[WCH+05]</a><a class="bibtex reference internal" href="../zreferences.html#candy-2005" id="id48">[Can05]</a> was found when electrons are kinetic.  These <em>corrugation</em> structures are electrostatic in nature, and most pronounced for lower-order surfaces</p>
<div class="math notranslate nohighlight">
\[q = \frac{1}{1}, \frac{2}{1}, \frac{3}{1}, \ldots \; ,\]</div>
<p>and are weaker for successively higher-order surfaces, like</p>
<div class="math notranslate nohighlight">
\[q = \frac{1}{2}, \frac{3}{2}, \frac{5}{2}, \ldots \; .\]</div>
<p>The width of these structures is on the order of a few ion gyroradii.</p>
</div>
<div class="section" id="id49">
<h3>2006<a class="headerlink" href="#id49" title="Permalink to this headline">¶</a></h3>
<p>GYRO results showed that ITG/TEM turbulence could induce the transport of energetic fusion alpha particles <a class="bibtex reference internal" href="../zreferences.html#estrada-2006b" id="id50">[EMCW06b]</a>.  Systematic safety factor, magnetic shear, and MHD alpha parameter scans <a class="bibtex reference internal" href="../zreferences.html#kinsey-2006" id="id51">[KWC06]</a> were carried out.  Theory and simulations of gyrokinetic turbulent heating <a class="bibtex reference internal" href="../zreferences.html#hinton-2006" id="id52">[HW06]</a> were published.  GYRO simulations which perfectly project profiles from dimensionally similar DIII-D discharges verified that the L-modes did indeed have Bohm scaling, and that the experimentally-inferred gyroBohm scaling in some H-modes was actually due to experimental profile <em>dissimilarity</em> <a class="bibtex reference internal" href="../zreferences.html#waltz-2006" id="id53">[WCP06]</a>.   The predicted <em>profile corrugations</em> in the electron temperature gradient were observed in <span class="math notranslate nohighlight">\(q_\mathrm{min} = 2\)</span> DIII-D discharges, and the attending <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> shear layer is believed to be the trigger for low-power reversed shear ITB formation <a class="bibtex reference internal" href="../zreferences.html#waltz-2006a" id="id54">[WABC06]</a>.  Density peaking via a particle pinch was demonstrated for a DIII-D L-mode plasma <a class="bibtex reference internal" href="../zreferences.html#estrada-2006" id="id55">[EMCW06a]</a>.</p>
<p>In studies relating to the foundation of gyrokinetic theory, the connection between velocity-space resolution, entropy production and conservation, and numerical dissipation was rigorously demonstrated <a class="bibtex reference internal" href="../zreferences.html#candy-2006" id="id56">[CW06]</a>, and the parallel nonlinearity was shown to be asymptotically subdominant (as required by the gyrokinetic ordering) to have a negligible effect on energy transport for experimentally-relevant discharges <a class="bibtex reference internal" href="../zreferences.html#candy-2006b" id="id57">[CWPC06]</a>.</p>
</div>
<div class="section" id="id58">
<h3>2007<a class="headerlink" href="#id58" title="Permalink to this headline">¶</a></h3>
<p>The capability to simultaneously treat electron and ion gyroaverages, and thus to perform fully-coupled, multi-scale ITG-ETG simulations, was added to GYRO <a class="bibtex reference internal" href="../zreferences.html#candy-2007b" id="id59">[CWFH07a]</a>.  The results of these simulations allowed us to make significant progress on the problem of electron-scale transport using coupled ITG/TEM-ETG turbulence at a reduced ion-to-electron mass ratio.  We were able to</p>
<ul class="simple">
<li><p>identify the failure of the popular adiabatic ion model of ETG transport <a class="bibtex reference internal" href="../zreferences.html#candy-2007" id="id60">[CWFH07b]</a>,</p></li>
<li><p>demonstrate the isotropy of short-wavelength fluctuations <a class="bibtex reference internal" href="../zreferences.html#waltz-2007" id="id61">[WCF07]</a><a class="bibtex reference internal" href="../zreferences.html#candy-2007" id="id62">[CWFH07b]</a> in the presence of long-wavelength ITG/TEM instabilities,</p></li>
<li><p>demonstrate the potential for ITG/TEM-scale instabilities to drive ETG transport in ETG-stable regimes <a class="bibtex reference internal" href="../zreferences.html#waltz-2007" id="id63">[WCF07]</a>,</p></li>
<li><p>demonstrate the potential for ETG transport to decouple from ITG transport in regimes where both are unstable <a class="bibtex reference internal" href="../zreferences.html#waltz-2007" id="id64">[WCF07]</a>,</p></li>
<li><p>demonstrate the reduction of ETG-transport by increasing ITG/TEM free energy <a class="bibtex reference internal" href="../zreferences.html#candy-2007b" id="id65">[CWFH07a]</a>,</p></li>
<li><p>demonstrate a <em>universal range</em> for ETG transport <a class="bibtex reference internal" href="../zreferences.html#candy-2007b" id="id66">[CWFH07a]</a>,</p></li>
<li><p>clarify <a class="reference download internal" download="" href="../_downloads/1ef69c2267187dc8cfbc394d28ff8a6f/etg_prl_comment.pdf"><code class="xref download docutils literal notranslate"><span class="pre">errors</span> <span class="pre">made</span> <span class="pre">in</span> <span class="pre">previous</span> <span class="pre">PIC</span> <span class="pre">simulations</span> <span class="pre">of</span> <span class="pre">ETG</span> <span class="pre">turbulence</span></code></a> .</p></li>
</ul>
<p>The first systematic studies of gyrokinetic momentum transport <a class="bibtex reference internal" href="../zreferences.html#waltz-2007b" id="id67">[WSCH07]</a>, including the effects of the angular momentum pinch from <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> shear as well as the coriolis pinch, were published, and the effect of plasma shape on <span class="math notranslate nohighlight">\(\mathbf{E}\times\mathbf{B}\)</span> shear quenching and transport was studied <a class="bibtex reference internal" href="../zreferences.html#kinsey-2007" id="id68">[KWC07]</a>.</p>
</div>
<div class="section" id="id69">
<h3>2008<a class="headerlink" href="#id69" title="Permalink to this headline">¶</a></h3>
<p>The next step in the validation of GYRO was also begun, with the development and application of synthetic BES and CECE diagnostics to allow direct comparisons of GYRO fluctuation predictions against DIII-D core turbulence measurements.  The initial results have been presented at a number of conferences and published in multiple journals <a class="bibtex reference internal" href="../zreferences.html#white-2008" id="id70">[WSM+08]</a><a class="bibtex reference internal" href="../zreferences.html#holland-2008" id="id71">[HCW+08]</a>.  The initial study focused upon modeling a steady, MHD-free L-mode DIII-D discharge, with the primary conclusions that:</p>
<ol class="arabic simple">
<li><p>Using local, fixed-gradient simulations, GYRO could match the <em>experimental</em> (as calculated via a ONETWO power balance analysis) energy flows within experimental gradient uncertainties for <span class="math notranslate nohighlight">\(r/a &lt; 0.6\)</span> (where <span class="math notranslate nohighlight">\(r/a\)</span> denotes normalized toroidal flux), but systematically underpredicted the energy flow at larger radii.</p></li>
<li><p>When the effects of the synthetic diagnostics were included, local GYRO simulations also accurately reproduced measured fluctuation spectra and correlation lengths at <span class="math notranslate nohighlight">\(r/a = 0.5\)</span>, but underpredicted the measured fluctuation amplitudes at <span class="math notranslate nohighlight">\(r/a = 0.75\)</span> by an amount consistent with the underprediction of the energy fluxes.  Interestingly, the shapes of the spectra and the correlation functions were still accurately reproduced at <span class="math notranslate nohighlight">\(r/a = 0.75\)</span>.</p></li>
</ol>
<p>What the source of the energy flow underprediction is, why the correlation functions and spectral shapes but not amplitudes are accurately predicted at <span class="math notranslate nohighlight">\(r/a = 0.75\)</span>, and whether these results hold for other experimental conditions remain open questions under active investigation at this time.</p>
<p>More results related to gyrokinetic turbulent heating <a class="bibtex reference internal" href="../zreferences.html#waltz-2008" id="id72">[WS08]</a> were published, and a study of GAMs in the context of the drift-wave-zonal-flow paradigm was carried out <a class="bibtex reference internal" href="../zreferences.html#waltz-2008b" id="id73">[WH08]</a> showing that it applies equally well to long-wavelength ITG/TEM and short-wavelength ETG turbulence.</p>
<p>Significant progress on <strong>neoclassical</strong> and <strong>steady-state transport physics</strong> was also made; these lines of research have a separate wiki.</p>
</div>
<div class="section" id="id74">
<h3>2009<a class="headerlink" href="#id74" title="Permalink to this headline">¶</a></h3>
<p>Researchers from MIT were able to demonstrate good agreement between GYRO and C-Mod experiment via synthetic PCI diagnostics <a class="bibtex reference internal" href="../zreferences.html#llin-2009" id="id75">[LPE+09]</a>.</p>
</div>
</div>
<div class="section" id="a-computational-science-and-user-perspective">
<h2>A Computational Science and User Perspective<a class="headerlink" href="#a-computational-science-and-user-perspective" title="Permalink to this headline">¶</a></h2>
<p>GYRO owes it’s computational efficiency in part to the strong support from the ORNL Center for Computational Science (CCS).  GYRO runs well on a wide range of small clusters to large supercomputers.  One can move between platforms seamlessly by setting a <strong>single environment variable</strong>.  GYRO was among the earliest applications ported to the Cray X1 and XT3 at ORNL.  The code is modular and the layout is carefully organized.  There are few uses of esoteric language features.  Initial X1 optimizations to take advantage of multistreaming and vectorization were quite successful for all but the collision operator.  A later effort to improve the performance on the collision operator yielded a factor-of-ten improvement on the X1, with an average 10% improvement on IBM and commodity systems.  Recent PERC data is available which analyzes GYRO performance on various HPC systems <a class="bibtex reference internal" href="../zreferences.html#worley-2005" id="id76">[WCC+05]</a> using the IPM, KOJAK, SvPablo, TAU and PMaC modeling tool suite.  Additional GYRO performance data on various systems (including the Cray X1, XD1 and XT3) has been presented by Vetter <a class="bibtex reference internal" href="../zreferences.html#vetter-2005" id="id77">[VATHD+05]</a>, Worley <a class="bibtex reference internal" href="../zreferences.html#worley-2005b" id="id78">[WATHD+05]</a> and Fahey <a class="bibtex reference internal" href="../zreferences.html#fahey-2004" id="id79">[FC04]</a>.  GYRO is presently so reliable that it is routinely used by ORNL staff to diagnose <em>system hardware and software issues</em>.  For example, chassis interconnect problems on the XD1, filesystem slowdown in the XT3, and memory management issues on the SGI Altix.</p>
<p>From the point of view of <em>utility</em>, the Eulerian codes GS2 and GYRO are set apart from all other codes in the US program in that they have a large (and growing) non-developer users group.  Numerous painstaking simulations of DIII-D, JET, JT60, and NSTX discharges have been made.  R. Bravenec and C. Holland have developed synthetic diagnostic tools to analyze GYRO data.</p>
<p>In addition to many Cyclone-based scans, we maintain a <a class="reference download internal" download="" href="../_downloads/3881d4fcf0de4ae62c476c508fc379e1/gyro-database.pdf"><code class="xref download docutils literal notranslate"><span class="pre">transport</span> <span class="pre">database</span></code></a> containing over 300 well-resolved flux tube simulations based on the GA standard case parameters <a class="bibtex reference internal" href="../zreferences.html#waltz-1997" id="id80">[WSD+97]</a>.  Nearly all of these give particle and energy transport coefficients for both electrons and ions.  Some also include momentum transport.   Additional scans are continuously being added to the database.  In our view, compiling a database of simulations is a key practical end-product of nonlinear gyrokinetic simulations.  This database provides the benchmarks and validation for the GA advanced gyrofluid transport model TGLF <a class="bibtex reference internal" href="../zreferences.html#staebler-2005" id="id81">[SKW05]</a><a class="bibtex reference internal" href="../zreferences.html#staebler-2007" id="id82">[SKW07]</a>.</p>
</div>
<div class="section" id="urban-legends">
<h2>Urban Legends<a class="headerlink" href="#urban-legends" title="Permalink to this headline">¶</a></h2>
<p>The Eulerian codes GS2 and GYRO have had to confront a number
of <a class="reference external" href="http://en.wikipedia.org/wiki/Urban_legend">urban legends</a> mostly in the form of unpublished/unsubstantiated claims circulating within the fusion theory community. These seem to originate from researchers having no first-hand experience with either Eulerian schemes or local simulations.  We number these for future reference.</p>
<div class="section" id="ul1-the-local-gyrobohm-limit-of-global-codes-differs-from-local-codes">
<h3>UL1: The local gyroBohm limit of global codes differs from local codes<a class="headerlink" href="#ul1-the-local-gyrobohm-limit-of-global-codes-differs-from-local-codes" title="Permalink to this headline">¶</a></h3>
<p>This cannot be true.  As <span class="math notranslate nohighlight">\(\rho_*\)</span> vanishes, the transport obtained from a global code reaches a limiting value at a given radial location.  This limiting value (i.e., the gyroBohm scaled limit) is identical to the local simulation result.  This not only provides the physical meaning of a local simulation, but is an important test of validity for local and global codes alike.  GYRO has passed this test repeatedly <a class="bibtex reference internal" href="../zreferences.html#candy-2004a" id="id84">[CWD04]</a><a class="bibtex reference internal" href="../zreferences.html#waltz-2002" id="id85">[WCR02]</a>.</p>
</div>
<div class="section" id="ul2-full-torus-simulations-are-necessary-to-correctly-compute-the-local-transport">
<h3>UL2: Full torus simulations are necessary to correctly compute the local transport<a class="headerlink" href="#ul2-full-torus-simulations-are-necessary-to-correctly-compute-the-local-transport" title="Permalink to this headline">¶</a></h3>
<p>DIII-D full-physics simulations which span 1/6th of a torus, 1/3rd of a torus, 1/2 of a torus, and a full torus give transport diffusivities which differ only by few percent <a class="bibtex reference internal" href="../zreferences.html#waltz-2005" id="id86">[WCH+05]</a>. In fact, full-torus simulations are generally wasteful of computer resources.  Global codes which are limited to full torus operation could obtain significantly more accurate results by simulating only a fraction of a torus but operating with a higher number of particles per cell and/or spatial resolution.</p>
</div>
<div class="section" id="ul3-eulerian-codes-have-inadequate-velocity-space-resolution">
<h3>UL3: Eulerian codes have inadequate velocity-space resolution<a class="headerlink" href="#ul3-eulerian-codes-have-inadequate-velocity-space-resolution" title="Permalink to this headline">¶</a></h3>
<p>The truth is in fact quite the opposite.  Published GYRO simulations are always checked for adequate grid convergence by the standard method of grid refinement.  GYRO has a particularly efficient velocity-space discretization scheme which suffers no accuracy loss even when the distribution is nearly discontinuous across the trapped-passing boundary.  We typically use 128 velocity gridpoints per real-space cell.  This is roughly equivalent to 128 particles per cell (PPC) in terms of points where the distribution function is known.  We emphasize that this was, until recently, <strong>significantly more</strong> than that typically used in PIC simulations <a class="footnote-reference brackets" href="#id98" id="id87">4</a>.  We have verified that no significant fine-scale structure in the distribution is being ignored or ‘’coarse-grained’’.  Recent GYRO work <a class="bibtex reference internal" href="../zreferences.html#candy-2006" id="id88">[CW06]</a> demonstrates a detailed steady-state balance between production of fluctuations and (numerical) dissipation, thus resolving the <em>entropy paradox</em> in a manner consistent with the picture developed by Krommes <a class="bibtex reference internal" href="../zreferences.html#krommes-1994" id="id89">[KH94]</a><a class="bibtex reference internal" href="../zreferences.html#krommes-1999" id="id90">[Kro99]</a>.  The numerical dissipation is also shown to be so small that it does not affect the observed transport.</p>
</div>
<div class="section" id="ul4-the-parallel-nonlinearity-can-have-a-dramatic-effect-on-the-transport">
<h3>UL4: The parallel nonlinearity can have a dramatic effect on the transport<a class="headerlink" href="#ul4-the-parallel-nonlinearity-can-have-a-dramatic-effect-on-the-transport" title="Permalink to this headline">¶</a></h3>
<p>This is false for realistic core tokamak parameters.  The so-called parallel nonlinearity (a velocity-space nonlinearity which is formally one order smaller in <span class="math notranslate nohighlight">\(\rho_*\)</span> than other terms in the gyrokinetic equations) is only one of several small terms commonly neglected in the standard operation of gyrokinetic codes.  GYRO has shown <a class="bibtex reference internal" href="../zreferences.html#candy-2006b" id="id91">[CWPC06]</a> that the parallel nonlinearity has no statistically significant effect on the diagnosed transport when <cite>rho_* &lt; 0.01</cite>. Moreover, the parallel nonlinearity has nothing whatsoever to do with the entropy paradox or with producing steady-states of turbulence.  To be clear the parallel nonlinearity (related to the nonlinear Landau damping and to wave-particle trapping) is the physical origin of a small turbulent heating source. GYRO is the first code to diagnostically calculate this heating <a class="bibtex reference internal" href="../zreferences.html#hinton-2006" id="id92">[HW06]</a>.</p>
<dl class="footnote brackets">
<dt class="label" id="id93"><span class="brackets"><a class="fn-backref" href="#id7">1</a></span></dt>
<dd><p>Practically speaking, global simulations allow modest profile variation within the simulation domain, where local simulations consider fixed temperature, density, shape, etc.  Even global simulations, however, must enforce the formal restrictions imposed by the gyrokinetic ordering.</p>
</dd>
<dt class="label" id="id94"><span class="brackets"><a class="fn-backref" href="#id19">2</a></span></dt>
<dd><p>Here, ITG-ae means ion-temperature-gradient modes with adiabatic electrons.</p>
</dd>
<dt class="label" id="id95"><span class="brackets"><a class="fn-backref" href="#id35">3</a></span></dt>
<dd><p>The transition is also dependent on the closeness to marginality <a class="bibtex reference internal" href="../zreferences.html#candy-2003b" id="id96">[CW03a]</a><a class="bibtex reference internal" href="../zreferences.html#waltz-2002" id="id97">[WCR02]</a>.</p>
</dd>
<dt class="label" id="id98"><span class="brackets"><a class="fn-backref" href="#id87">4</a></span></dt>
<dd><p>Since the publication of the Nevins-Hammett theory of PIC noise <a class="bibtex reference internal" href="../zreferences.html#nevins-2005" id="id99">[NHD+05]</a>, the typical number of particles per cell in PIC simulations seems to have grown, whereas the GYRO resolution has remain unchanged over approximately 6 years and probably over a thousand simulations.</p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="gyro_gallery.html" class="btn btn-neutral float-right" title="Gallery of classic GYRO images (circa 2003)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="gyro_vv.html" class="btn btn-neutral float-left" title="GYRO verification and validation (pre 2010)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2010-2020

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>