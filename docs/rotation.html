

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>PLASMA ROTATION &mdash; GACODE</title>
  

  
  
  
  

  

  
  
    

  

  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="input.profiles" href="input_profiles.html" />
    <link rel="prev" title="FLUX-SURFACE GEOMETRY" href="geometry.html" /> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> GACODE
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="download.html">Download and user agreement</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Install and build GACODE</a></li>
<li class="toctree-l1"><a class="reference internal" href="zreferences.html">References</a></li>
</ul>
<p class="caption"><span class="caption-text">Codes</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="neo.html">NEO</a></li>
<li class="toctree-l1"><a class="reference internal" href="tgyro.html">TGYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="cgyro.html">CGYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="gyro.html">GYRO</a></li>
<li class="toctree-l1"><a class="reference internal" href="tglf.html">TGLF</a></li>
</ul>
<p class="caption"><span class="caption-text">Physics</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="geometry.html">FLUX-SURFACE GEOMETRY</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">PLASMA ROTATION</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#physical-considerations">Physical considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sonic-rotation-formalism">Sonic rotation formalism</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-rotation-profile">The rotation profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-parameters">Input parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#theoretical-basis-for-sonic-rotation">Theoretical basis for sonic rotation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#connection-to-experimental-data">Connection to experimental data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="input_profiles.html">input.profiles</a></li>
<li class="toctree-l1"><a class="reference internal" href="shortfall.html">DIII-D L-mode shortfall</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">GACODE</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>PLASMA ROTATION</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/rotation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="plasma-rotation">
<h1>PLASMA ROTATION<a class="headerlink" href="#plasma-rotation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="physical-considerations">
<h2>Physical considerations<a class="headerlink" href="#physical-considerations" title="Permalink to this headline">¶</a></h2>
<p>Sonic rotation can arise in tokamaks from torque due to neutral beam injection.  It is
believed to play an important role in the suppression of turbulence and the formation of
transport barriers through <span class="math">\(\mathbf{E}\times\mathbf{B}\)</span> shear.  In addition, it
produces a strong centrifugal force that pushes ions toroidally outward, causing them to
redistribute nonuniformly around a flux surface.  As a result of quasi-neutrality, a
poloidally-varying electrostatic potential is generated by the electrons to balance the
density asymmetry.  This generates <strong>centrifugal drifts</strong> in addition to the
usual <span class="math">\(\mathbf{E}\times\mathbf{B}\)</span> rotation, Coriolis drift, and parallel velocity shear.
Because of their complexity, these centrifugal effects, which are second-order in the main
ion Mach number, are ignored in most neoclassical and gyrokinetic codes.  Inclusion of full
sonic rotation effects is particularly critical for studying transport of heavy impurities,
as the influence of the centrifugal force is amplified by their large mass.</p>
</div>
<div class="section" id="sonic-rotation-formalism">
<h2>Sonic rotation formalism<a class="headerlink" href="#sonic-rotation-formalism" title="Permalink to this headline">¶</a></h2>
<p>The rigorous derivation of the gyrokinetic equations for sonic rotation was carried out by Sugama
<a class="reference internal" href="zreferences.html#sugama-1998" id="id1">[SH98]</a>.  Sugama followed the underlying rotation formulation of Hinton
and Wong <a class="reference internal" href="zreferences.html#hinton-1985" id="id2">[HW85]</a>, who showed that in an axisymmetric system the
zeroth-order flow velocity is</p>
<div class="math">
\[\mathbf{U}_0 = \omega_0(\psi) R^2 \nabla \varphi \; .\]</div>
<p>It is this scalar flux-function, <span class="math">\(\omega_0\)</span>, that is the true free (input) function in
neoclassical and gyrokinetic theory.  Here, <span class="math">\(\psi\)</span> is the poloidal flux.</p>
</div>
<div class="section" id="the-rotation-profile">
<h2>The rotation profile<a class="headerlink" href="#the-rotation-profile" title="Permalink to this headline">¶</a></h2>
<p>The relevant profile that gives a <em>complete specification of rotation</em>
is the potential <span class="math">\(\omega_0(r)\)</span>, which in defined consistently throughout
GACODE as</p>
<div class="math">
\[\omega_0(r) = -c \frac{d \Phi}{d \psi} \simeq \frac{c E_r }{R B_p} \; .\]</div>
<p>In the strictest sense, <span class="math">\(\Phi(r)\)</span> above is the leading-order potential <span class="math">\(\Phi_{-1}(r)\)</span>
that is constant on a flux surface.  Because the meaning of <span class="math">\(\Phi_{-1}(r)\)</span> is ambiguous in
an experimental sense, it is perhaps most useful to rely on the final approximate expression in
terms of <span class="math">\(E_r\)</span>.  We believe this form is intuitively appealing and connects most clearly
with experimental data.   These issue are described in full detail in the papers of Hinton and
Sugama.</p>
</div>
<div class="section" id="input-parameters">
<h2>Input parameters<a class="headerlink" href="#input-parameters" title="Permalink to this headline">¶</a></h2>
<p>CGYRO and NEO implement <em>full sonic rotation</em> (GYRO implements only a reduced model) according to the
formulation of Hinton and Wong [Phys. Fluids 28, 3082 (1985)].  Neoclassically, the induced poloidally-varying
electrostatic potential leads to the formation of potential wells.  In the banana regime these increase
the effective trapped particle fraction, and in the Pfirsh-Schluter regime increase the effective toroidal
curvature.  In both instances, this may lead to enhanced neoclassical transport.  The code inputs are</p>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="38%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">input.cgyro parameter</th>
<th class="head">Definition</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="cgyro/cgyro_list.html#cgyro-gamma-e"><span class="std std-ref">GAMMA_E</span></a></td>
<td><span class="math">\(\displaystyle \frac{a}{c_s} \, \gamma_{\rm E} \doteq -\frac{r}{q}\frac{d \omega_{0}}{d r}\)</span></td>
<td><span class="math">\(\mathbf{E}\times\mathbf{B}\)</span> shearing rate</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="cgyro/cgyro_list.html#cgyro-gamma-p"><span class="std std-ref">GAMMA_P</span></a></td>
<td><span class="math">\(\displaystyle \frac{a}{c_s} \, \gamma_p \doteq -R_0\frac{d \omega_{0}}{d r}\)</span></td>
<td>rotation shearing rate</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="cgyro/cgyro_list.html#cgyro-mach"><span class="std std-ref">MACH</span></a></td>
<td><span class="math">\(\displaystyle M \doteq \frac{\omega_0 R_0}{c_s}\)</span></td>
<td>rotation shearing rate</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="25%" />
<col width="38%" />
<col width="38%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">input.neo parameter</th>
<th class="head">Definition</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><a class="reference internal" href="neo/neo_list.html#neo-omega-rot"><span class="std std-ref">OMEGA_ROT</span></a></td>
<td><span class="math">\(\displaystyle  \frac{a}{v_{norm}} \omega_0\)</span></td>
<td>rotation rate</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="neo/neo_list.html#neo-omega-rot-deriv"><span class="std std-ref">OMEGA_ROT_DERIV</span></a></td>
<td><span class="math">\(\displaystyle \frac{a^{2}}{v_{norm}} \frac{d \omega_{0}}{dr}\)</span></td>
<td>derivative of rotation rate</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="theoretical-basis-for-sonic-rotation">
<h2>Theoretical basis for sonic rotation<a class="headerlink" href="#theoretical-basis-for-sonic-rotation" title="Permalink to this headline">¶</a></h2>
<p>In presence of rapid rotation, where the flow speed <span class="math">\(U\)</span> is allowed to be of the order of the ion thermal speed, the Lorentz
force term in the the Fokker-Planck equation (see <a class="reference internal" href="zreferences.html#hinton-1985" id="id3">[HW85]</a>)</p>
<div class="math">
\[\frac{\partial f_i}{\partial t} + \mathbf{v} \cdot \nabla f_i + \frac{e}{m_i}(\mathbf{E}+\mathbf{v} \times \mathbf{B})
\cdot \frac{\partial f_i}{\partial \mathbf{v}} = C_i + S_i\]</div>
<p>becomes the leading term.  Under these circumstances Hinton and Wong show that</p>
<div class="math">
\[\mathbf{E}_{-1} + \frac{\mathbf{U}_0}{c} \times \mathbf{B} = 0\]</div>
<p>where the subscripts represents the order with respect to the <strong>drift ordering</strong> in <span class="math">\(\rho_i/a\)</span>.
Here <span class="math">\(\mathbf{U}_0\)</span> is a purely toroidal velocity and is species independent.  This ordering is applied to
all fields and moments</p>
<div class="math">
\[\begin{split}\begin{align}
f_i  &amp; = ~~~~~~~~~~~ f_{i,0} + f_{i,1} + \ldots \\
\Phi &amp; = \Phi_{-1} + \Phi_0 + \Phi_1 + \ldots \\
\mathbf{U} &amp; = ~~~~~~~~~~~ \mathbf{U}_0 + \mathbf{U}_1 + \ldots \\
U_\varphi &amp; =  ~~~~~~~~~~~ U_{\varphi,0} + U_{\varphi,1} + \ldots \\
U_\theta  &amp; =  ~~~~~~~~~~~~~~~~~~~~~~ U_{\theta,1} + \ldots
\end{align}\end{split}\]</div>
<p>where <span class="math">\(U_\varphi \doteq \mathbf{e}_\varphi \cdot \mathbf{U}\)</span> is the <strong>toroidal velocity</strong> and <span class="math">\(U_\theta \doteq \mathbf{e}_\theta \cdot \mathbf{U}\)</span>
is the <strong>poloidal velocity</strong>.  The leading-order sonic flow is toroidal and independent of species</p>
<div class="math">
\[\mathbf{U}_0 = \omega_0(\psi) R \mathbf{e}_{\varphi} \quad \text{where} \quad
\omega_{0}(\psi) \doteq -c \frac{d \Phi_{-1}}{d \psi}\]</div>
<p>It is important to note that <span class="math">\(\Phi_{-1}\)</span> is a <strong>flux function</strong>, whereas higher orders are not constant on a flux surface.</p>
</div>
<div class="section" id="connection-to-experimental-data">
<h2>Connection to experimental data<a class="headerlink" href="#connection-to-experimental-data" title="Permalink to this headline">¶</a></h2>
<p>We remark that <span class="math">\(\omega_{0}\)</span> is a <strong>theoretical quantity</strong> that cannot be measured in the experiment.  This is similar
to the observation that the experimentally-measured temperature <span class="math">\(T\)</span> is really the sum of the temperatures to all orders,</p>
<div class="math">
\[T = T_0 + T_1 + \ldots \; .\]</div>
<p>In practice, however, we approximate the equilibrium temperature <span class="math">\(T_0\)</span> by the measured temperature <span class="math">\(T_0 \simeq T\)</span>.
For the rotation frequency, we note that the theory shows that the potential always appears in the combination</p>
<div class="math">
\[\Phi_{-1} + \left\langle \Phi_0 \right\rangle\]</div>
<p>where an angle bracket denotes a flux-surface average.  By analogy with the temperature, the rotation frequency can related to the
experimentally-measured radial electric field <span class="math">\(E_r\)</span>, where <span class="math">\(E_r = -|\nabla r| d\Phi/dr\)</span>, according to</p>
<div class="math">
\[\omega_0 + \omega_1 \simeq  \frac{c E_r(0)}{R B_p} \quad\text{where}\quad \omega_1 \doteq -c \frac{d  \left\langle \Phi_0 \right\rangle }{d\psi}\]</div>
<p>In practice, we can set <span class="math">\(\omega_1 = 0\)</span> <em>without loss of generality</em> and all the rotation is contained in <span class="math">\(\omega_0\)</span>.
Alternatively, in the diamagnetic rotation limit, we set <span class="math">\(\omega_0 = 0\)</span> with the rotation contained in <span class="math">\(\omega_1\)</span>.
Finally, the toroidal velocities <span class="math">\(U_{\varphi,0} + U_{\varphi,1}\)</span> are treated in the same way.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="input_profiles.html" class="btn btn-neutral float-right" title="input.profiles" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="geometry.html" class="btn btn-neutral" title="FLUX-SURFACE GEOMETRY" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2010-2018.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            LANGUAGE:'en',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  <script type="text/javascript">
      jQuery(function () {
          
          SphinxRtdTheme.Navigation.enableSticky();
          
      });
  </script> 

</body>
</html>